<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de Propinas</title>

<style>
:root {
  --primary:#1f2937;
  --accent:#22c55e;
  --bg:#f3f4f6;
}
* { box-sizing:border-box; }
body {
  margin:0;
  font-family: system-ui, -apple-system;
  background: var(--bg);
}
.app {
  max-width:420px;
  margin:auto;
  min-height:100vh;
  display:flex;
  flex-direction:column;
}
.header {
  background: var(--primary);
  color:white;
  padding:20px;
  text-align:center;
}
.card {
  background:white;
  margin:20px;
  padding:20px;
  border-radius:16px;
  box-shadow:0 10px 20px rgba(0,0,0,.08);
}
label {
  font-size:14px;
  color:#6b7280;
}
input {
  width:100%;
  padding:14px;
  font-size:18px;
  margin-top:6px;
  margin-bottom:18px;
  border-radius:12px;
  border:1px solid #d1d5db;
}
button {
  width:100%;
  padding:16px;
  font-size:18px;
  border:none;
  border-radius:14px;
  background: var(--accent);
  color:white;
  font-weight:600;
}
.status {
  text-align:center;
  margin-top:15px;
  font-size:14px;
  color:#6b7280;
}
.footer {
  margin-top:auto;
  text-align:center;
  font-size:12px;
  color:#9ca3af;
  padding:15px;
}
</style>
</head>

<body>
<div class="app">

  <div class="header">
    <h2>Registro Diario</h2>
    <p style="margin:0;font-size:14px;">Propina individual</p>
  </div>

  <div class="card">
    <label>Mesero</label>
    <input id="empleado" readonly>

    <label>Propina del día</label>
    <input id="propina" type="number" placeholder="$0.00">

    <button onclick="enviar()">Registrar Propina</button>
    <div class="status" id="status"></div>
  </div>

  <div class="footer">
    Sistema de propinas · Registro diario
  </div>

</div>

<script>
const params = new URLSearchParams(window.location.search);
const empleado = params.get("id");
document.getElementById("empleado").value = empleado || "NO IDENTIFICADO";

function enviar() {
  const propina = document.getElementById("propina").value;
  const status = document.getElementById("status");

  if (!propina || propina <= 0) {
    status.textContent = "Ingresa una propina válida";
    return;
  }

  status.textContent = "Registrando...";

  fetch("https://script.google.com/macros/s/AKfycbwAHMzEfraG70Y1LEgPuzL6JSIG2H1xt1gVEpeDGRK8suNrRIDLZQaW_XDD5jtfn2qR/exec", {
    method: "POST",
    body: JSON.stringify({
      empleado: empleado,
      propina: propina
    })
  })
  .then(r => r.text())
  .then(res => {
    status.textContent =
      res === "YA_REGISTRADO"
      ? "⚠️ Ya registraste hoy"
      : "✅ Propina registrada";
    document.getElementById("propina").value = "";
  })
  .catch(() => status.textContent = "❌ Error de conexión");
}
</script>

</body>
</html>
